<!DOCTYPE html>
<html lang="en-US" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1314&amp;path=livereload" data-no-instant defer></script>
  <!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Step-by-step guide to install, configure, and run UnisonDB in under 5 minutes. Learn how to set up server and replica modes for real-time data replication and edge deployment.">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="http://localhost:1314/docs/getting-started/">
  <meta property="og:site_name" content="UnisonDB">
  <meta property="og:title" content="Getting Started with UnisonDB">
  <meta property="og:description" content="Step-by-step guide to install, configure, and run UnisonDB in under 5 minutes. Learn how to set up server and replica modes for real-time data replication and edge deployment.">
  <meta property="og:locale" content="en_US">
  <meta property="og:type" content="website">
    <meta property="og:image" content="http://localhost:1314/images/getting_started.jpg">


  <meta itemprop="name" content="Getting Started with UnisonDB">
  <meta itemprop="description" content="Step-by-step guide to install, configure, and run UnisonDB in under 5 minutes. Learn how to set up server and replica modes for real-time data replication and edge deployment.">
  <meta itemprop="wordCount" content="1303">
  <meta itemprop="image" content="http://localhost:1314/images/getting_started.jpg">
  <meta itemprop="keywords" content="UnisonDB quick start,install UnisonDB,UnisonDB tutorial,edge computing database setup,real-time replication database,WAL-based database,distributed database getting started,UnisonDB server mode,UnisonDB replica mode,UnisonDB configuration guide">

<title>Getting Started | UnisonDB</title>
<link rel="icon" href="/images/logo.svg" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="http://localhost:1314/docs/getting-started/">
<link rel="stylesheet" href="/book.min.cc2c524ed250aac81b23d1f4af87344917b325208841feca0968fe450f570575.css" integrity="sha256-zCxSTtJQqsgbI9H0r4c0SRezJSCIQf7KCWj&#43;RQ9XBXU=" crossorigin="anonymous">


  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.d17dc9f8d796258208051f49c3cd56bf1f018f2cc043167555ff4ba36b9c2714.js" integrity="sha256-0X3J&#43;NeWJYIIBR9Jw81Wvx8BjyzAQxZ1Vf9Lo2ucJxQ=" crossorigin="anonymous"></script>

  <script defer src="/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js" integrity="sha256-b2&#43;Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC&#43;NdcPIvZhzk=" crossorigin="anonymous"></script>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-GXZKSVMHYJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-GXZKSVMHYJ');
</script>

<link rel="alternate" type="application/rss+xml" href="http://localhost:1314/docs/getting-started/index.xml" title="UnisonDB" />

  <link rel="apple-touch-icon" sizes="180x180" href="http://localhost:1314/images/apple-touch-icon.png">

<meta name="robots" content="index, follow">
<meta name="googlebot" content="index, follow">

<meta name="author" content="Ankur Anand">
<meta name="keywords" content="UnisonDB quick start, install UnisonDB, UnisonDB tutorial, edge computing database setup, real-time replication database, WAL-based database, distributed database getting started, UnisonDB server mode, UnisonDB replica mode, UnisonDB configuration guide">



  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1314/images/getting_started.jpg">
  <meta name="twitter:title" content="Getting Started with UnisonDB">
  <meta name="twitter:description" content="Step-by-step guide to install, configure, and run UnisonDB in under 5 minutes. Learn how to set up server and replica modes for real-time data replication and edge deployment.">



<meta name="twitter:site" content="@in_aanand">
<meta name="twitter:creator" content="@in_aanand">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "@id": "https://unisondb.io/#website",
  "name": "UnisonDB",
  "url": "https://unisondb.io/",
  "inLanguage": "en-US",
  "description": "Step-by-step guide to install, configure, and run UnisonDB in under 5 minutes. Learn how to set up server and replica modes for real-time data replication and edge deployment.",
  "publisher": {
    "@type": "Organization",
    "@id": "https://unisondb.io/#organization",
    "name": "The UnisonDB Authors",
    "url": "https://unisondb.io/",
    "logo": {
      "@type": "ImageObject",
      "url": "https://unisondb.io/images/logo.svg"
    }
  },
  "potentialAction": {
    "@type": "SearchAction",
    "target": {
      "@type": "EntryPoint",
      "urlTemplate": "https://unisondb.io/?s={search_term_string}"
    },
    "query-input": "required name=search_term_string"
  }
}
</script>




</head>
<body dir="ltr" class="book-kind-section book-type-docs">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    
<aside class="book-menu">
  <div class="book-menu-content">
    
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><img src="/images/logo.svg" alt="Logo" /><span>UnisonDB</span>
  </a>
</h2>


<div class="book-search hidden">
  <input id="book-search-input" type="text" 
    placeholder="Search"
    aria-label="Search"
    maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>












<ul>

  
    
      <li>
        
  
  

  
    <a href="/docs/getting-started/" class="active">
      Getting Started</a>
  

        
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/getting-started/configurations/" class="">
      Configuration</a>
  

        </li>
      
    
  </ul>

      </li>
    
  
    
      <li>
        
  
  

  
    <a href="/docs/architecture/" class="">
      Architecture Overview</a>
  

        
  <ul>
    
  </ul>

      </li>
    
  
    
      <li>
        
  
  

  
    <a href="/docs/api/" class="">
      API Reference</a>
  

        
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/api/http-api/" class="">
      HTTP API Reference</a>
  

        </li>
      
    
  </ul>

      </li>
    
  
    
      <li>
        
  
  

  
    <a href="/docs/deployment/" class="">
      Deployment Topologies</a>
  

        
  <ul>
    
  </ul>

      </li>
    
  
    
      <li>
        
  
  

  
    <a href="/docs/operations/" class="">
      Operations</a>
  

        
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/operations/backup-restore/" class="">
      Backup and Restore</a>
  

        </li>
      
    
  </ul>

      </li>
    
  
    
      <li>
        
  
  

  
    <a href="/docs/examples/" class="">
      Examples</a>
  

        
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/examples/multi-dc-crdt/" class="">
      Multi-DC CRDT Replication</a>
  

        </li>
      
    
  </ul>

      </li>
    
  




  <li class="book-section-flat"  class="book-section-collapse" >
    
  
  

  
    <input type="checkbox" id="section-9a540b355eab634b7d2d40f68ad2c4e6" class="toggle"  />
    <label for="section-9a540b355eab634b7d2d40f68ad2c4e6" class="flex">
      <a role="button" class="">
        Blog Posts</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

    
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/blog/building-corruption-proof-write-ahead-log-in-go/" class="">
      Building a Corruption-Proof Write-Ahead Log in Go</a>
  

        </li>
      
    
  </ul>

  </li>

</ul>











<ul>
  <li>
    <a href="https://github.com/ankur-anand/unisondb" target="_blank" rel="noopener" class="book-github-link">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="book-icon">
        <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
      </svg>
      GitHub
    </a>
  </li>
  <li>
    <a href="https://github.com/ankur-anand/unisondb/discussions" target="_blank" rel="noopener" class="book-discussions-link">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="book-icon">
        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
      </svg>
      Discussions
    </a>
  </li>
</ul>

</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>



  </div>
</aside>
 

    <div class="book-page">
      <header class="book-header hidden">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/icons/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>Getting Started</h3>

  <label for="toc-control">
    
    <img src="/icons/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#getting-started-with-unisondb">Getting Started with UnisonDB</a>
      <ul>
        <li><a href="#table-of-contents">Table of Contents</a></li>
        <li><a href="#prerequisites">Prerequisites</a>
          <ul>
            <li><a href="#system-requirements">System Requirements</a></li>
          </ul>
        </li>
        <li><a href="#installation">Installation</a>
          <ul>
            <li><a href="#building-from-source">Building from Source</a></li>
            <li><a href="#building-with-fuzzer-support-optional">Building with Fuzzer Support (Optional)</a></li>
            <li><a href="#installation-to-system-path-optional">Installation to System Path (Optional)</a></li>
          </ul>
        </li>
        <li><a href="#running-in-server-mode">Running in Server Mode</a>
          <ul>
            <li><a href="#1-generate-tls-certificates-recommended">1. Generate TLS Certificates (Recommended)</a></li>
            <li><a href="#2-create-server-configuration">2. Create Server Configuration</a></li>
            <li><a href="#3-start-the-server">3. Start the Server</a></li>
            <li><a href="#4-verify-server-is-running">4. Verify Server is Running</a></li>
            <li><a href="#development-mode-insecure">Development Mode (Insecure)</a></li>
          </ul>
        </li>
        <li><a href="#running-in-replica-mode">Running in Replica Mode</a>
          <ul>
            <li><a href="#1-create-replica-configuration">1. Create Replica Configuration</a></li>
            <li><a href="#2-start-the-replica">2. Start the Replica</a></li>
            <li><a href="#3-enable-relay-mode-multi-hop">3. Enable Relay Mode (Multi-Hop)</a></li>
            <li><a href="#development-mode-insecure-1">Development Mode (Insecure)</a></li>
          </ul>
        </li>
        <li><a href="#basic-operations">Basic Operations</a>
          <ul>
            <li><a href="#writing-data">Writing Data</a></li>
            <li><a href="#reading-data">Reading Data</a></li>
            <li><a href="#subscribing-to-changes-zeromq">Subscribing to Changes (ZeroMQ)</a></li>
          </ul>
        </li>
        <li><a href="#common-deployment-patterns">Common Deployment Patterns</a>
          <ul>
            <li><a href="#1-single-server-development">1. Single Server (Development)</a></li>
            <li><a href="#2-server--single-replica-read-scaling">2. Server + Single Replica (Read Scaling)</a></li>
            <li><a href="#3-server--multiple-replicas-edge-computing">3. Server + Multiple Replicas (Edge Computing)</a></li>
            <li><a href="#4-multi-hop-relay--replica">4. Multi-Hop (Relay → Replica)</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h1 id="getting-started-with-unisondb">Getting Started with UnisonDB<a class="anchor" href="#getting-started-with-unisondb">#</a></h1>
<img src="/images/getting_started.svg" alt="Getting Started with UnisonDB" style="max-width: 100%; height: auto;" />
<p>This guide will walk you through installing UnisonDB, configuring it, and running it in both Server and Replica modes.</p>
<pre tabindex="0"><code>          ┌────────────────┐
          │    Server      │
          │  (Primary)     │
          │  Writes → WAL  │
          │  Streams gRPC  │
          └──────┬─────────┘
                 │
        WAL Stream (gRPC)
                 │
   ┌─────────────┴──────────────┐
   ↓                            ↓
┌───────────┐              ┌───────────┐
│ Replica 1 │              │ Replica 2 │
│ (Reader)  │              │ (Reader)  │
│ Local DB  │              │ Local DB  │
│ Watch API │              │ Watch API │
└───────────┘              └───────────┘</code></pre><h2 id="table-of-contents">Table of Contents<a class="anchor" href="#table-of-contents">#</a></h2>
<ul>
<li><a href="#prerequisites" target="_blank" rel="noopener noreferrer">Prerequisites</a>
</li>
<li><a href="#installation" target="_blank" rel="noopener noreferrer">Installation</a>
</li>
<li><a href="#running-in-server-mode" target="_blank" rel="noopener noreferrer">Running in Server Mode</a>
</li>
<li><a href="#running-in-replica-mode" target="_blank" rel="noopener noreferrer">Running in Replica Mode</a>
</li>
</ul>
<h2 id="prerequisites">Prerequisites<a class="anchor" href="#prerequisites">#</a></h2>
<h3 id="system-requirements">System Requirements<a class="anchor" href="#system-requirements">#</a></h3>
<ul>
<li><strong>Operating System</strong>: Linux or macOS</li>
<li><strong>Go</strong>: Version 1.24 or higher</li>
</ul>
<h2 id="installation">Installation<a class="anchor" href="#installation">#</a></h2>
<h3 id="building-from-source">Building from Source<a class="anchor" href="#building-from-source">#</a></h3>
<p>UnisonDB requires CGO to be enabled for LMDB bindings.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Clone the repository</span>
</span></span><span style="display:flex;"><span>git clone https://github.com/ankur-anand/unisondb.git
</span></span><span style="display:flex;"><span>cd unisondb
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Enable CGO (required for LMDB)</span>
</span></span><span style="display:flex;"><span>export CGO_ENABLED<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Build the binary</span>
</span></span><span style="display:flex;"><span>go build -o unisondb ./cmd/unisondb
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Verify installation</span>
</span></span><span style="display:flex;"><span>./unisondb --help</span></span></code></pre></div><p>Expected output:</p>
<pre tabindex="0"><code>  _   _          _                     ___    ___
 | | | |  _ _   (_)  ___  ___   _ _   |   \  | _ )
 | |_| | | &#39; \  | | (_-&lt; / _ \ | &#39; \  | |) | | _ \
  \___/  |_||_| |_| /__/ \___/ |_||_| |___/  |___/

     Database + Message Bus. Built for Edge.
               https://unisondb.io

NAME:
   unisondb - Run UnisonDB

USAGE:
   unisondb [global options] command [command options]

COMMANDS:
   server      Run in server mode (primary, accepts writes)
   replica     Run in replica mode (read-only, streams from upstream)
   relay       Run in relay mode (replica with gRPC for downstream)
   fuzz        This is a testing-only feature (disabled in production builds)
   help, h     Shows a list of commands or help for one command

GLOBAL OPTIONS:
   --config value, -c value  Path to TOML config file (default: &#34;./config.toml&#34;) [$UNISON_CONFIG]
   --env value, -e value     Environment: dev, staging, prod (default: &#34;dev&#34;) [$UNISON_ENV]
   --help, -h                show help</code></pre><h3 id="building-with-fuzzer-support-optional">Building with Fuzzer Support (Optional)<a class="anchor" href="#building-with-fuzzer-support-optional">#</a></h3>
<p>For testing and development, you can build with fuzzer support:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>CGO_ENABLED<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> go build -tags fuzz -o unisondb ./cmd/unisondb</span></span></code></pre></div><p><strong>Note</strong>: When built with <code>-tags fuzz</code>:</p>
<ul>
<li><code>fuzz</code> command is available</li>
<li><code>server</code> command is <strong>disabled</strong> for safety</li>
</ul>
<p>To run fuzzer mode:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./unisondb fuzz --config config.toml</span></span></code></pre></div><h3 id="installation-to-system-path-optional">Installation to System Path (Optional)<a class="anchor" href="#installation-to-system-path-optional">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Move to system path</span>
</span></span><span style="display:flex;"><span>sudo mv unisondb /usr/local/bin/
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Verify</span>
</span></span><span style="display:flex;"><span>unisondb --help</span></span></code></pre></div><h2 id="running-in-server-mode">Running in Server Mode<a class="anchor" href="#running-in-server-mode">#</a></h2>
<p>Server Mode runs UnisonDB as a <strong>primary instance</strong> that accepts writes and serves reads.</p>
<h3 id="1-generate-tls-certificates-recommended">1. Generate TLS Certificates (Recommended)<a class="anchor" href="#1-generate-tls-certificates-recommended">#</a></h3>
<p>For production or multi-node setups, generate TLS certificates for gRPC:</p>
<p><strong>Using OpenSSL</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir -p certs <span style="color:#f92672">&amp;&amp;</span> cd certs
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Generate CA</span>
</span></span><span style="display:flex;"><span>openssl genrsa -out ca.key <span style="color:#ae81ff">4096</span>
</span></span><span style="display:flex;"><span>openssl req -new -x509 -key ca.key -sha256 -subj <span style="color:#e6db74">&#34;/CN=UnisonDB CA&#34;</span> -days <span style="color:#ae81ff">365</span> -out ca.crt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Generate server certificate</span>
</span></span><span style="display:flex;"><span>openssl genrsa -out server.key <span style="color:#ae81ff">4096</span>
</span></span><span style="display:flex;"><span>openssl req -new -key server.key -out server.csr -subj <span style="color:#e6db74">&#34;/CN=localhost&#34;</span>
</span></span><span style="display:flex;"><span>openssl x509 -req -in server.csr -CA ca.crt -CAkey ca.key -CAcreateserial -out server.crt -days <span style="color:#ae81ff">365</span> -sha256
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Generate client certificate</span>
</span></span><span style="display:flex;"><span>openssl genrsa -out client.key <span style="color:#ae81ff">4096</span>
</span></span><span style="display:flex;"><span>openssl req -new -key client.key -out client.csr -subj <span style="color:#e6db74">&#34;/CN=client&#34;</span>
</span></span><span style="display:flex;"><span>openssl x509 -req -in client.csr -CA ca.crt -CAkey ca.key -CAcreateserial -out client.crt -days <span style="color:#ae81ff">365</span> -sha256
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cd ..</span></span></code></pre></div><h3 id="2-create-server-configuration">2. Create Server Configuration<a class="anchor" href="#2-create-server-configuration">#</a></h3>
<p>Create a <code>server.toml</code> configuration file:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-toml" data-lang="toml"><span style="display:flex;"><span><span style="color:#75715e">## HTTP API port</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">http_port</span> = <span style="color:#ae81ff">4000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">listen_ip</span> = <span style="color:#e6db74">&#34;0.0.0.0&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## gRPC configuration (for replication)</span>
</span></span><span style="display:flex;"><span>[<span style="color:#a6e22e">grpc_config</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">listen_ip</span> = <span style="color:#e6db74">&#34;0.0.0.0&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">port</span> = <span style="color:#ae81ff">4001</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cert_path</span> = <span style="color:#e6db74">&#34;./certs/server.crt&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">key_path</span> = <span style="color:#e6db74">&#34;./certs/server.key&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ca_path</span> = <span style="color:#e6db74">&#34;./certs/ca.crt&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># For development only - allows insecure connections</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">allow_insecure</span> = <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Storage configuration</span>
</span></span><span style="display:flex;"><span>[<span style="color:#a6e22e">storage_config</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">base_dir</span> = <span style="color:#e6db74">&#34;./data/server&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">namespaces</span> = [<span style="color:#e6db74">&#34;default&#34;</span>, <span style="color:#e6db74">&#34;users&#34;</span>, <span style="color:#e6db74">&#34;products&#34;</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">bytes_per_sync</span> = <span style="color:#e6db74">&#34;1MB&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">segment_size</span> = <span style="color:#e6db74">&#34;16MB&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">arena_size</span> = <span style="color:#e6db74">&#34;4MB&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">wal_fsync_interval</span> = <span style="color:#e6db74">&#34;1s&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## WAL cleanup (prevents disk exhaustion)</span>
</span></span><span style="display:flex;"><span>[<span style="color:#a6e22e">storage_config</span>.<span style="color:#a6e22e">wal_cleanup_config</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">enabled</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">interval</span> = <span style="color:#e6db74">&#34;5m&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">max_age</span> = <span style="color:#e6db74">&#34;1h&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">min_segments</span> = <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">max_segments</span> = <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Write notification coalescing</span>
</span></span><span style="display:flex;"><span>[<span style="color:#a6e22e">write_notify_config</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">enabled</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">max_delay</span> = <span style="color:#e6db74">&#34;20ms&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## ZeroMQ notifications (optional - for local apps)</span>
</span></span><span style="display:flex;"><span>[<span style="color:#a6e22e">notifier_config</span>.<span style="color:#a6e22e">default</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">bind_port</span> = <span style="color:#ae81ff">5555</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">high_water_mark</span> = <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">linger_time</span> = <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#a6e22e">notifier_config</span>.<span style="color:#a6e22e">users</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">bind_port</span> = <span style="color:#ae81ff">5556</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">high_water_mark</span> = <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">linger_time</span> = <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Profiling endpoint</span>
</span></span><span style="display:flex;"><span>[<span style="color:#a6e22e">pprof_config</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">enabled</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">port</span> = <span style="color:#ae81ff">6060</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Logging</span>
</span></span><span style="display:flex;"><span>[<span style="color:#a6e22e">log_config</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">log_level</span> = <span style="color:#e6db74">&#34;info&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#a6e22e">log_config</span>.<span style="color:#a6e22e">min_level_percents</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">debug</span> = <span style="color:#ae81ff">100.0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">info</span>  = <span style="color:#ae81ff">100.0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">warn</span>  = <span style="color:#ae81ff">100.0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">error</span> = <span style="color:#ae81ff">100.0</span></span></span></code></pre></div><h3 id="3-start-the-server">3. Start the Server<a class="anchor" href="#3-start-the-server">#</a></h3>
<p><strong>Server Mode</strong> (using <code>server</code> command):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./unisondb server --config server.toml</span></span></code></pre></div><h3 id="4-verify-server-is-running">4. Verify Server is Running<a class="anchor" href="#4-verify-server-is-running">#</a></h3>
<p><strong>Check HTTP health endpoint</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl http://localhost:4000/health</span></span></code></pre></div><h3 id="development-mode-insecure">Development Mode (Insecure)<a class="anchor" href="#development-mode-insecure">#</a></h3>
<p>For quick local testing without TLS:</p>
<p><strong>server-dev.toml</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-toml" data-lang="toml"><span style="display:flex;"><span><span style="color:#a6e22e">http_port</span> = <span style="color:#ae81ff">4000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#a6e22e">grpc_config</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">port</span> = <span style="color:#ae81ff">4001</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">allow_insecure</span> = <span style="color:#66d9ef">true</span>  <span style="color:#75715e"># WARNING: Development only!</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#a6e22e">storage_config</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">base_dir</span> = <span style="color:#e6db74">&#34;./data/server&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">namespaces</span> = [<span style="color:#e6db74">&#34;default&#34;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#a6e22e">log_config</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">log_level</span> = <span style="color:#e6db74">&#34;debug&#34;</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./unisondb server --config server-dev.toml</span></span></code></pre></div><h2 id="running-in-replica-mode">Running in Replica Mode<a class="anchor" href="#running-in-replica-mode">#</a></h2>
<p>Replica Mode runs UnisonDB as a <strong>read-only replica</strong> that streams changes from an upstream server.</p>
<h3 id="1-create-replica-configuration">1. Create Replica Configuration<a class="anchor" href="#1-create-replica-configuration">#</a></h3>
<p>Create a <code>replica.toml</code> configuration file:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-toml" data-lang="toml"><span style="display:flex;"><span><span style="color:#75715e">## HTTP API port (different from server)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">http_port</span> = <span style="color:#ae81ff">5000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">listen_ip</span> = <span style="color:#e6db74">&#34;0.0.0.0&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## gRPC config (can accept downstream replicas)</span>
</span></span><span style="display:flex;"><span>[<span style="color:#a6e22e">grpc_config</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">listen_ip</span> = <span style="color:#e6db74">&#34;0.0.0.0&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">port</span> = <span style="color:#ae81ff">5001</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cert_path</span> = <span style="color:#e6db74">&#34;./certs/server.crt&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">key_path</span> = <span style="color:#e6db74">&#34;./certs/server.key&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ca_path</span> = <span style="color:#e6db74">&#34;./certs/ca.crt&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Storage configuration</span>
</span></span><span style="display:flex;"><span>[<span style="color:#a6e22e">storage_config</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">base_dir</span> = <span style="color:#e6db74">&#34;./data/replica&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">namespaces</span> = [<span style="color:#e6db74">&#34;default&#34;</span>, <span style="color:#e6db74">&#34;users&#34;</span>, <span style="color:#e6db74">&#34;products&#34;</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">bytes_per_sync</span> = <span style="color:#e6db74">&#34;1MB&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># IMPORTANT: segment_size MUST match upstream server!</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">segment_size</span> = <span style="color:#e6db74">&#34;16MB&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">arena_size</span> = <span style="color:#e6db74">&#34;4MB&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Replica configuration - connects to upstream</span>
</span></span><span style="display:flex;"><span>[<span style="color:#a6e22e">replica_config</span>.<span style="color:#a6e22e">primary</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">namespaces</span> = [<span style="color:#e6db74">&#34;default&#34;</span>, <span style="color:#e6db74">&#34;users&#34;</span>, <span style="color:#e6db74">&#34;products&#34;</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cert_path</span> = <span style="color:#e6db74">&#34;./certs/client.crt&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">key_path</span> = <span style="color:#e6db74">&#34;./certs/client.key&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ca_path</span> = <span style="color:#e6db74">&#34;./certs/ca.crt&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">upstream_address</span> = <span style="color:#e6db74">&#34;localhost:4001&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">segment_lag_threshold</span> = <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">allow_insecure</span> = <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Optional: Connect to multiple upstreams</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># [replica_config.secondary]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># namespaces = [&#34;products&#34;]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># upstream_address = &#34;other-server:4001&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># cert_path = &#34;./certs/client.crt&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># key_path = &#34;./certs/client.key&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ca_path = &#34;./certs/ca.crt&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## ZeroMQ notifications (optional)</span>
</span></span><span style="display:flex;"><span>[<span style="color:#a6e22e">notifier_config</span>.<span style="color:#a6e22e">default</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">bind_port</span> = <span style="color:#ae81ff">6555</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">high_water_mark</span> = <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">linger_time</span> = <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Logging</span>
</span></span><span style="display:flex;"><span>[<span style="color:#a6e22e">log_config</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">log_level</span> = <span style="color:#e6db74">&#34;info&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#a6e22e">log_config</span>.<span style="color:#a6e22e">min_level_percents</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">debug</span> = <span style="color:#ae81ff">1.0</span>   <span style="color:#75715e"># Sample 1% of debug logs</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">info</span>  = <span style="color:#ae81ff">10.0</span>  <span style="color:#75715e"># Sample 10% of info logs</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">warn</span>  = <span style="color:#ae81ff">100.0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">error</span> = <span style="color:#ae81ff">100.0</span></span></span></code></pre></div><h3 id="2-start-the-replica">2. Start the Replica<a class="anchor" href="#2-start-the-replica">#</a></h3>
<p><strong>Start replica</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./unisondb replica --config replica.toml</span></span></code></pre></div><h3 id="3-enable-relay-mode-multi-hop">3. Enable Relay Mode (Multi-Hop)<a class="anchor" href="#3-enable-relay-mode-multi-hop">#</a></h3>
<p>To allow downstream replicas to connect, use <code>relay</code> mode instead:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./unisondb relay --config replica.toml</span></span></code></pre></div><p>This enables the node to act as both a <strong>consumer</strong> (from upstream) and a <strong>producer</strong> (to downstream).</p>
<h3 id="development-mode-insecure-1">Development Mode (Insecure)<a class="anchor" href="#development-mode-insecure-1">#</a></h3>
<p><strong>replica-dev.toml</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-toml" data-lang="toml"><span style="display:flex;"><span><span style="color:#a6e22e">http_port</span> = <span style="color:#ae81ff">5000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#a6e22e">grpc_config</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">port</span> = <span style="color:#ae81ff">5001</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#a6e22e">storage_config</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">base_dir</span> = <span style="color:#e6db74">&#34;./data/replica&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">namespaces</span> = [<span style="color:#e6db74">&#34;default&#34;</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">segment_size</span> = <span style="color:#e6db74">&#34;16MB&#34;</span>  <span style="color:#75715e"># Must match server!</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#a6e22e">replica_config</span>.<span style="color:#a6e22e">primary</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">namespaces</span> = [<span style="color:#e6db74">&#34;default&#34;</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">upstream_address</span> = <span style="color:#e6db74">&#34;localhost:4001&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">allow_insecure</span> = <span style="color:#66d9ef">true</span>  <span style="color:#75715e"># WARNING: Development only!</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">segment_lag_threshold</span> = <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#a6e22e">log_config</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">log_level</span> = <span style="color:#e6db74">&#34;debug&#34;</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./unisondb replica --config replica-dev.toml</span></span></code></pre></div><h2 id="basic-operations">Basic Operations<a class="anchor" href="#basic-operations">#</a></h2>
<h3 id="writing-data">Writing Data<a class="anchor" href="#writing-data">#</a></h3>
<p><strong>Key-Value Write</strong> (via HTTP):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Put a key-value pair</span>
</span></span><span style="display:flex;"><span>curl -X POST http://localhost:4000/api/v1/namespaces/default/kv <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -H <span style="color:#e6db74">&#34;Content-Type: application/json&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -d <span style="color:#e6db74">&#39;{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;key&#34;: &#34;user:123&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;value&#34;: &#34;eyJuYW1lIjoiQWxpY2UiLCJlbWFpbCI6ImFsaWNlQGV4YW1wbGUuY29tIn0=&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  }&#39;</span></span></span></code></pre></div><p><strong>Batch Write</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -X POST http://localhost:4000/api/v1/namespaces/default/kv/batch <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -H <span style="color:#e6db74">&#34;Content-Type: application/json&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -d <span style="color:#e6db74">&#39;{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;operations&#34;: [
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      {&#34;key&#34;: &#34;user:1&#34;, &#34;value&#34;: &#34;...&#34;},
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      {&#34;key&#34;: &#34;user:2&#34;, &#34;value&#34;: &#34;...&#34;},
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      {&#34;key&#34;: &#34;user:3&#34;, &#34;value&#34;: &#34;...&#34;}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    ]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  }&#39;</span></span></span></code></pre></div><h3 id="reading-data">Reading Data<a class="anchor" href="#reading-data">#</a></h3>
<p><strong>Read from Server</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl http://localhost:4000/api/v1/namespaces/default/kv/user:123</span></span></code></pre></div><p><strong>Read from Replica</strong> (same API):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl http://localhost:5000/api/v1/namespaces/default/kv/user:123</span></span></code></pre></div><h3 id="subscribing-to-changes-zeromq">Subscribing to Changes (ZeroMQ)<a class="anchor" href="#subscribing-to-changes-zeromq">#</a></h3>
<ul>
<li>Build UnisonDB with ZeroMQ Lib</li>
</ul>
<p>This needs Zero MQ Installed Make Sure You&rsquo;ve have it Installed.
<a href="https://zeromq.org/download/" target="_blank" rel="noopener noreferrer">Install ZeroMQ dependency </a>
</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Clone the repository</span>
</span></span><span style="display:flex;"><span>git clone https://github.com/ankur-anand/unisondb.git
</span></span><span style="display:flex;"><span>cd unisondb
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Build the binary (CGO required for RocksDB)</span>
</span></span><span style="display:flex;"><span>CGO_ENABLED<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> go build -tags zeromq ./cmd/unisondb</span></span></code></pre></div><p><strong>Python example</strong> (install <code>pyzmq</code> first):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> zmq
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context <span style="color:#f92672">=</span> zmq<span style="color:#f92672">.</span>Context()
</span></span><span style="display:flex;"><span>socket <span style="color:#f92672">=</span> context<span style="color:#f92672">.</span>socket(zmq<span style="color:#f92672">.</span>SUB)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Subscribe to &#39;default&#39; namespace</span>
</span></span><span style="display:flex;"><span>socket<span style="color:#f92672">.</span>connect(<span style="color:#e6db74">&#34;tcp://localhost:5555&#34;</span>)
</span></span><span style="display:flex;"><span>socket<span style="color:#f92672">.</span>setsockopt(zmq<span style="color:#f92672">.</span>SUBSCRIBE, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&#34;</span>)  <span style="color:#75715e"># Subscribe to all messages</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Listening for changes on namespace &#39;default&#39;...&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>    message <span style="color:#f92672">=</span> socket<span style="color:#f92672">.</span>recv()
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Change notification: </span><span style="color:#e6db74">{</span>message<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)</span></span></code></pre></div><p><strong>Run the subscriber</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>python subscriber.py</span></span></code></pre></div><p>Now any writes to the <code>default</code> namespace will trigger notifications!</p>
<h2 id="common-deployment-patterns">Common Deployment Patterns<a class="anchor" href="#common-deployment-patterns">#</a></h2>
<h3 id="1-single-server-development">1. Single Server (Development)<a class="anchor" href="#1-single-server-development">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Terminal 1: Start server</span>
</span></span><span style="display:flex;"><span>./unisondb server --config server-dev.toml</span></span></code></pre></div><h3 id="2-server--single-replica-read-scaling">2. Server + Single Replica (Read Scaling)<a class="anchor" href="#2-server--single-replica-read-scaling">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Terminal 1: Start server</span>
</span></span><span style="display:flex;"><span>./unisondb server --config server.toml
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 2: Start replica</span>
</span></span><span style="display:flex;"><span>./unisondb replica --config replica.toml</span></span></code></pre></div><h3 id="3-server--multiple-replicas-edge-computing">3. Server + Multiple Replicas (Edge Computing)<a class="anchor" href="#3-server--multiple-replicas-edge-computing">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Terminal 1: Start server</span>
</span></span><span style="display:flex;"><span>./unisondb server --config server.toml
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 2: Start replica 1</span>
</span></span><span style="display:flex;"><span>./unisondb replica --config replica1.toml
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 3: Start replica 2</span>
</span></span><span style="display:flex;"><span>./unisondb replica --config replica2.toml
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 4: Start replica 3</span>
</span></span><span style="display:flex;"><span>./unisondb replica --config replica3.toml</span></span></code></pre></div><h3 id="4-multi-hop-relay--replica">4. Multi-Hop (Relay → Replica)<a class="anchor" href="#4-multi-hop-relay--replica">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Terminal 1: Primary server</span>
</span></span><span style="display:flex;"><span>./unisondb server --config server.toml
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 2: L1 relay (with gRPC for downstream)</span>
</span></span><span style="display:flex;"><span>./unisondb relay --config relay-l1.toml
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Terminal 3: L2 replica (connects to L1)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Update replica-l2.toml upstream_address to point to L1 (localhost:5001)</span>
</span></span><span style="display:flex;"><span>./unisondb replica --config replica-l2.toml</span></span></code></pre></div><p>Happy building with UnisonDB!</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">

<div>

</div>

<div>

  <a class="flex align-center" href="https://github.com/ankur-anand/unisondb/edit/main/docs/content/docs/getting-started/_index.md" target="_blank" rel="noopener edit">
    <img src="/icons/edit.svg" class="book-icon" alt="Edit" />
    <span>Edit this page</span>
  </a>

</div>

</div>





  
  
  
  <div class="flex flex-wrap justify-between">
    <span>
    
    </span>
    <span>
    
      <a href="/docs/getting-started/configurations/" class="flex align-center">
        <span>Configuration</span>
        <img src="/icons/forward.svg" class="book-icon" alt="Forward" />
      </a>
    
    </span>
  </div>
  


 
        
  
 
        
        
  
 
        
  
  
    <script>(function(){document.querySelectorAll("pre:has(code)").forEach(e=>{e.addEventListener("click",e.focus),e.addEventListener("copy",function(t){if(t.preventDefault(),navigator.clipboard){const t=window.getSelection().toString()||e.textContent;navigator.clipboard.writeText(t)}})})})()</script>
  

      </footer>

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
  
  <aside class="book-toc">
    <div class="book-toc-content">
      
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#getting-started-with-unisondb">Getting Started with UnisonDB</a>
      <ul>
        <li><a href="#table-of-contents">Table of Contents</a></li>
        <li><a href="#prerequisites">Prerequisites</a>
          <ul>
            <li><a href="#system-requirements">System Requirements</a></li>
          </ul>
        </li>
        <li><a href="#installation">Installation</a>
          <ul>
            <li><a href="#building-from-source">Building from Source</a></li>
            <li><a href="#building-with-fuzzer-support-optional">Building with Fuzzer Support (Optional)</a></li>
            <li><a href="#installation-to-system-path-optional">Installation to System Path (Optional)</a></li>
          </ul>
        </li>
        <li><a href="#running-in-server-mode">Running in Server Mode</a>
          <ul>
            <li><a href="#1-generate-tls-certificates-recommended">1. Generate TLS Certificates (Recommended)</a></li>
            <li><a href="#2-create-server-configuration">2. Create Server Configuration</a></li>
            <li><a href="#3-start-the-server">3. Start the Server</a></li>
            <li><a href="#4-verify-server-is-running">4. Verify Server is Running</a></li>
            <li><a href="#development-mode-insecure">Development Mode (Insecure)</a></li>
          </ul>
        </li>
        <li><a href="#running-in-replica-mode">Running in Replica Mode</a>
          <ul>
            <li><a href="#1-create-replica-configuration">1. Create Replica Configuration</a></li>
            <li><a href="#2-start-the-replica">2. Start the Replica</a></li>
            <li><a href="#3-enable-relay-mode-multi-hop">3. Enable Relay Mode (Multi-Hop)</a></li>
            <li><a href="#development-mode-insecure-1">Development Mode (Insecure)</a></li>
          </ul>
        </li>
        <li><a href="#basic-operations">Basic Operations</a>
          <ul>
            <li><a href="#writing-data">Writing Data</a></li>
            <li><a href="#reading-data">Reading Data</a></li>
            <li><a href="#subscribing-to-changes-zeromq">Subscribing to Changes (ZeroMQ)</a></li>
          </ul>
        </li>
        <li><a href="#common-deployment-patterns">Common Deployment Patterns</a>
          <ul>
            <li><a href="#1-single-server-development">1. Single Server (Development)</a></li>
            <li><a href="#2-server--single-replica-read-scaling">2. Server + Single Replica (Read Scaling)</a></li>
            <li><a href="#3-server--multiple-replicas-edge-computing">3. Server + Multiple Replicas (Edge Computing)</a></li>
            <li><a href="#4-multi-hop-relay--replica">4. Multi-Hop (Relay → Replica)</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>



    </div>
  </aside>
  
 
  </main>

  
</body>
</html>




















