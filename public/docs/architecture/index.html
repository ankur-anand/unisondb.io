<!DOCTYPE html>
<html lang="en-US" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Learn how UnisonDB’s log-native architecture unifies database durability and message-bus replication — designed for AI agents, edge computing, and real-time data streaming.">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="http://localhost:1313/docs/architecture/">
  <meta property="og:site_name" content="UnisonDB">
  <meta property="og:title" content="Architecture Overview – Log-Native Database for Edge and AI Systems">
  <meta property="og:description" content="Learn how UnisonDB’s log-native architecture unifies database durability and message-bus replication — designed for AI agents, edge computing, and real-time data streaming.">
  <meta property="og:locale" content="en_US">
  <meta property="og:type" content="website">
    <meta property="og:image" content="http://localhost:1313/images/unisondb_architecture.png">


  <meta itemprop="name" content="Architecture Overview – Log-Native Database for Edge and AI Systems">
  <meta itemprop="description" content="Learn how UnisonDB’s log-native architecture unifies database durability and message-bus replication — designed for AI agents, edge computing, and real-time data streaming.">
  <meta itemprop="wordCount" content="1570">
  <meta itemprop="image" content="http://localhost:1313/images/unisondb_architecture.png">
  <meta itemprop="keywords" content="UnisonDB architecture,log-native database,edge AI database,edge computing database,AI agents database,real-time replication,write-ahead log,WAL streaming replication,multi-model storage engine,local-first database,distributed database design,reactive database architecture,gRPC replication,B&#43;Tree storage engine,database for AI and edge computing">

<title>Architecture Overview | UnisonDB</title>
<link rel="icon" href="/images/logo.svg" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="http://localhost:1313/docs/architecture/">
<link rel="stylesheet" href="/book.min.cc2c524ed250aac81b23d1f4af87344917b325208841feca0968fe450f570575.css" integrity="sha256-zCxSTtJQqsgbI9H0r4c0SRezJSCIQf7KCWj&#43;RQ9XBXU=" crossorigin="anonymous">


  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.c70ace00361da3a26e14c88da6953d426c69d8dc0e15b858ad0fd7c3655a79a2.js" integrity="sha256-xwrOADYdo6JuFMiNppU9Qmxp2NwOFbhYrQ/Xw2VaeaI=" crossorigin="anonymous"></script>

  <script defer src="/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js" integrity="sha256-b2&#43;Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC&#43;NdcPIvZhzk=" crossorigin="anonymous"></script>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-GXZKSVMHYJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-GXZKSVMHYJ');
</script>

<link rel="alternate" type="application/rss+xml" href="http://localhost:1313/docs/architecture/index.xml" title="UnisonDB" />

  <link rel="apple-touch-icon" sizes="180x180" href="http://localhost:1313/images/apple-touch-icon.png">

<meta name="robots" content="index, follow">
<meta name="googlebot" content="index, follow">

<meta name="author" content="Ankur Anand">
<meta name="keywords" content="UnisonDB architecture, log-native database, edge AI database, edge computing database, AI agents database, real-time replication, write-ahead log, WAL streaming replication, multi-model storage engine, local-first database, distributed database design, reactive database architecture, gRPC replication, B&#43;Tree storage engine, database for AI and edge computing">



  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/images/unisondb_architecture.png">
  <meta name="twitter:title" content="Architecture Overview – Log-Native Database for Edge and AI Systems">
  <meta name="twitter:description" content="Learn how UnisonDB’s log-native architecture unifies database durability and message-bus replication — designed for AI agents, edge computing, and real-time data streaming.">



<meta name="twitter:site" content="@in_aanand">
<meta name="twitter:creator" content="@in_aanand">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "@id": "https://unisondb.io/#website",
  "name": "UnisonDB",
  "url": "https://unisondb.io/",
  "inLanguage": "en-US",
  "description": "Learn how UnisonDB’s log-native architecture unifies database durability and message-bus replication — designed for AI agents, edge computing, and real-time data streaming.",
  "publisher": {
    "@type": "Organization",
    "@id": "https://unisondb.io/#organization",
    "name": "The UnisonDB Authors",
    "url": "https://unisondb.io/",
    "logo": {
      "@type": "ImageObject",
      "url": "https://unisondb.io/images/logo.svg"
    }
  },
  "potentialAction": {
    "@type": "SearchAction",
    "target": {
      "@type": "EntryPoint",
      "urlTemplate": "https://unisondb.io/?s={search_term_string}"
    },
    "query-input": "required name=search_term_string"
  }
}
</script>




</head>
<body dir="ltr" class="book-kind-section book-type-docs">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    
<aside class="book-menu">
  <div class="book-menu-content">
    
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><img src="/images/logo.svg" alt="Logo" /><span>UnisonDB</span>
  </a>
</h2>


<div class="book-search hidden">
  <input id="book-search-input" type="text" 
    placeholder="Search"
    aria-label="Search"
    maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>












<ul>

  
    
      <li>
        
  
  

  
    <a href="/docs/getting-started/" class="">
      Getting Started</a>
  

        
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/getting-started/configurations/" class="">
      Configuration</a>
  

        </li>
      
    
  </ul>

      </li>
    
  
    
      <li>
        
  
  

  
    <a href="/docs/architecture/" class="active">
      Architecture Overview</a>
  

        
  <ul>
    
  </ul>

      </li>
    
  
    
      <li>
        
  
  

  
    <a href="/docs/api/" class="">
      API Reference</a>
  

        
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/api/http-api/" class="">
      HTTP API Reference</a>
  

        </li>
      
    
  </ul>

      </li>
    
  
    
      <li>
        
  
  

  
    <a href="/docs/deployment/" class="">
      Deployment Topologies</a>
  

        
  <ul>
    
  </ul>

      </li>
    
  
    
      <li>
        
  
  

  
    <a href="/docs/operations/" class="">
      Operations</a>
  

        
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/operations/backup-restore/" class="">
      Backup and Restore</a>
  

        </li>
      
    
  </ul>

      </li>
    
  
    
      <li>
        
  
  

  
    <a href="/docs/examples/" class="">
      Examples</a>
  

        
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/examples/multi-dc-crdt/" class="">
      Multi-DC CRDT Replication</a>
  

        </li>
      
    
  </ul>

      </li>
    
  




  <li class="book-section-flat"  class="book-section-collapse" >
    
  
  

  
    <input type="checkbox" id="section-9a540b355eab634b7d2d40f68ad2c4e6" class="toggle"  />
    <label for="section-9a540b355eab634b7d2d40f68ad2c4e6" class="flex">
      <a role="button" class="">
        Blog Posts</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

    
  <ul>
    
  </ul>

  </li>

</ul>











<ul>
  <li>
    <a href="https://github.com/ankur-anand/unisondb" target="_blank" rel="noopener" class="book-github-link">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="book-icon">
        <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
      </svg>
      GitHub
    </a>
  </li>
  <li>
    <a href="https://github.com/ankur-anand/unisondb/discussions" target="_blank" rel="noopener" class="book-discussions-link">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="book-icon">
        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
      </svg>
      Discussions
    </a>
  </li>
</ul>

</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>



  </div>
</aside>
 

    <div class="book-page">
      <header class="book-header hidden">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/icons/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>Architecture Overview</h3>

  <label for="toc-control">
    
    <img src="/icons/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#architecture-overview">Architecture Overview</a>
      <ul>
        <li><a href="#key-characteristics">Key Characteristics</a></li>
        <li><a href="#core-concepts">Core Concepts</a>
          <ul>
            <li><a href="#1-log-native-design">1. Log-Native Design</a></li>
            <li><a href="#2-operational-modes">2. Operational Modes</a></li>
            <li><a href="#3-dual-communication-channels">3. Dual Communication Channels</a></li>
          </ul>
        </li>
        <li><a href="#system-architecture">System Architecture</a></li>
        <li><a href="#core-components">Core Components</a>
          <ul>
            <li><a href="#write-ahead-log-wal">Write-Ahead Log (WAL)</a></li>
            <li><a href="#storage-engine">Storage Engine</a></li>
            <li><a href="#replication-system">Replication System</a></li>
            <li><a href="#namespace-watch-api">Namespace Watch API</a></li>
          </ul>
        </li>
        <li><a href="#design-principles">Design Principles</a>
          <ul>
            <li><a href="#multi-modal-storage-examples">Multi-Modal Storage Examples</a></li>
            <li><a href="#edge-first-topology">Edge-First Topology</a></li>
          </ul>
        </li>
        <li><a href="#data-flow">Data Flow</a>
          <ul>
            <li><a href="#write-path-server-mode">Write Path (Server Mode)</a></li>
            <li><a href="#read-path">Read Path</a></li>
            <li><a href="#replication-flow-grpc">Replication Flow (gRPC)</a></li>
            <li><a href="#watch-event-flow">Watch Event Flow</a></li>
          </ul>
        </li>
        <li><a href="#storage-layout">Storage Layout</a></li>
        <li><a href="#system-characteristics">System Characteristics</a>
          <ul>
            <li><a href="#consistency-model">Consistency Model</a></li>
            <li><a href="#durability--recovery">Durability &amp; Recovery</a></li>
          </ul>
        </li>
        <li><a href="#deployment-topologies">Deployment Topologies</a>
          <ul>
            <li><a href="#example-hub-and-spoke">Example: Hub-and-Spoke</a></li>
          </ul>
        </li>
        <li><a href="#tradeoffs--limitations">Tradeoffs &amp; Limitations</a>
          <ul>
            <li><a href="#design-tradeoffs">Design Tradeoffs</a></li>
            <li><a href="#current-limitations">Current Limitations</a></li>
            <li><a href="#when-to-use-unisondb">When to Use UnisonDB</a></li>
          </ul>
        </li>
        <li><a href="#summary">Summary</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h1 id="architecture-overview">Architecture Overview<a class="anchor" href="#architecture-overview">#</a></h1>
<img src="/images/unisondb_architecture.svg" alt="UnisonDB Architecture Diagram" style="max-width: 100%; height: auto;" />
<p>UnisonDB is a <strong>log-native, real-time database</strong> that replicates like a message bus — merging transactional consistency with streaming replication. It’s purpose-built for <a href="https://www.ibm.com/think/topics/edge-ai" target="_blank" rel="noopener noreferrer"><strong>Edge AI</strong></a>
, <a href="https://en.wikipedia.org/wiki/Edge_computing" target="_blank" rel="noopener noreferrer"><strong>Edge Computing</strong></a>
, and local-first distributed systems that demand low-latency synchronization across nodes.</p>
<h2 id="key-characteristics">Key Characteristics<a class="anchor" href="#key-characteristics">#</a></h2>
<table>
  <thead>
      <tr>
          <th>Aspect</th>
          <th>Design Choice</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Storage Model</strong></td>
          <td>Multi-modal: Key-Value, Wide-Column, Large Objects (LOB)</td>
      </tr>
      <tr>
          <td><strong>Storage Engine</strong></td>
          <td>B+Tree (LMDB/BoltDB) with in-memory MemTable overlay</td>
      </tr>
      <tr>
          <td><strong>Replication</strong></td>
          <td>Log streaming (gRPC) with eventual consistency</td>
      </tr>
      <tr>
          <td><strong>Watch API</strong></td>
          <td>Best-effort change notifications (per-namespace)</td>
      </tr>
      <tr>
          <td><strong>Consistency</strong></td>
          <td>Single-primary writes, eventual consistency for replicas</td>
      </tr>
      <tr>
          <td><strong>Durability</strong></td>
          <td>WAL-first with configurable fsync</td>
      </tr>
      <tr>
          <td><strong>Deployment Modes</strong></td>
          <td>Replicator (writable primary) &amp; Relayer (read-only replica)</td>
      </tr>
  </tbody>
</table>
<h2 id="core-concepts">Core Concepts<a class="anchor" href="#core-concepts">#</a></h2>
<h3 id="1-log-native-design">1. Log-Native Design<a class="anchor" href="#1-log-native-design">#</a></h3>
<p>The Write-Ahead Log (WAL) is a <strong>first-class citizen</strong>, not just a recovery mechanism.</p>
<ul>
<li><strong>Replication = Log streaming</strong>: No separate replication protocol</li>
<li><strong>Recovery = Log replay</strong>: State reconstructed from WAL</li>
<li><strong>Time-travel enabled</strong>: Historic snapshots from log</li>
<li><strong>Single source of truth</strong>: All operations flow through WAL</li>
</ul>
<h3 id="2-operational-modes">2. Operational Modes<a class="anchor" href="#2-operational-modes">#</a></h3>
<p>UnisonDB instances run in one of two modes:</p>
<h4 id="replicator-mode-primary">Replicator Mode (Primary)<a class="anchor" href="#replicator-mode-primary">#</a></h4>
<p>Writable instance that maintains the authoritative WAL.</p>
<pre tabindex="0"><code>┌─────────────────────────────────────┐
│     Replicator Mode Instance        │
│                                     │
│  • Accepts writes (HTTP API)        │
│  • Maintains authoritative WAL      │
│  • Streams to relayers (gRPC)       │
│  • Publishes watch events (local)   │
│  • Serves reads from local storage  │
└─────────────────────────────────────┘</code></pre><h4 id="relayer-mode-replica">Relayer Mode (Replica)<a class="anchor" href="#relayer-mode-replica">#</a></h4>
<p>Read-only instance that streams changes from upstream replicators.</p>
<pre tabindex="0"><code>┌─────────────────────────────────────┐
│        Relayer Mode Instance        │
│                                     │
│  • Connects to upstream (gRPC)      │
│  • Receives WAL segment streams     │
│  • Applies to local storage (RO)    │
│  • Can relay to downstream nodes    │
│  • Publishes watch events (local)   │
│  • Serves reads (data locality)     │
└─────────────────────────────────────┘</code></pre><h3 id="3-dual-communication-channels">3. Dual Communication Channels<a class="anchor" href="#3-dual-communication-channels">#</a></h3>
<p>UnisonDB separates <strong>distribution</strong> from <strong>local reactivity</strong>:</p>
<table>
  <thead>
      <tr>
          <th>Channel</th>
          <th>Purpose</th>
          <th>Use Case</th>
          <th>Scope</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>gRPC</strong></td>
          <td>Durable replication</td>
          <td>Node-to-node WAL streaming</td>
          <td>Network (cross-machine)</td>
      </tr>
      <tr>
          <td><strong>Watch API</strong></td>
          <td>Best-effort notifications</td>
          <td>Local application reactivity</td>
          <td>IPC (same machine)</td>
      </tr>
  </tbody>
</table>
<p><strong>Design Rationale</strong>:</p>
<ul>
<li><strong>gRPC Replication</strong>: Network-tolerant, authenticated, durable, at-least-once delivery</li>
<li><strong>Watch API</strong>: Lightweight, fire-and-forget, at-most-once, local-only</li>
</ul>
<h2 id="system-architecture">System Architecture<a class="anchor" href="#system-architecture">#</a></h2>
<pre tabindex="0"><code>┌────────────────────────────────────────────────────────────────────┐
│                        UnisonDB Instance                           │
├────────────────────────────────────────────────────────────────────┤
│  Client APIs                                                       │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐              │
│  │  HTTP REST   │  │ Transactions │  │ Admin/Stats  │              │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘              │
│         └─────────────────┴─────────────────┘                      │
├────────────────────────────────────────────────────────────────────┤
│  Storage Models                                                    │
│  ┌─────────────┐  ┌──────────────┐  ┌──────────────┐               │
│  │ Key-Value   │  │ Wide-Column  │  │ Large Object │               │
│  └──────┬──────┘  └──────┬───────┘  └──────┬───────┘               │
│         └────────────────┴─────────────────┘                       │
├────────────────────────────────────────────────────────────────────┤
│  Storage Engine (dbkernel)                                         │
│                                                                    │
│  Write:  WAL (append) → MemTable → B+Tree (LMDB)                   │
│  Read:   MemTable + B+Tree → Response                              │
├────────────────────────────────────────────────────────────────────┤
│  Distribution Layer                                                │
│  ┌──────────────────────┐     ┌──────────────────────┐             │
│  │  gRPC Replicator     │     │  Watch API           │             │
│  │  • WAL streaming     │     │  • Change events     │             │
│  │  • TLS/mTLS          │     │  • Per-namespace     │             │
│  │  • At-least-once     │     │  • At-most-once      │             │
│  └──────────┬───────────┘     └──────────┬───────────┘             │
│             v                            v                         │
│      Remote Relayers              Local Applications               │
└────────────────────────────────────────────────────────────────────┘</code></pre><h2 id="core-components">Core Components<a class="anchor" href="#core-components">#</a></h2>
<h3 id="write-ahead-log-wal">Write-Ahead Log (WAL)<a class="anchor" href="#write-ahead-log-wal">#</a></h3>
<p>Append-only transaction log that serves as the source of truth.</p>
<table>
  <thead>
      <tr>
          <th>Property</th>
          <th>Implementation</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Structure</strong></td>
          <td>Segmented files (configurable size, default 16MB)</td>
      </tr>
      <tr>
          <td><strong>Format</strong></td>
          <td>Binary with CRC32 checksums per entry</td>
      </tr>
      <tr>
          <td><strong>Lifecycle</strong></td>
          <td>Write → fsync → MemTable → B+Tree → Segment cleanup</td>
      </tr>
      <tr>
          <td><strong>Purpose</strong></td>
          <td>Durability, replication streaming, crash recovery</td>
      </tr>
  </tbody>
</table>
<p><strong>Segment Format</strong>:</p>
<pre tabindex="0"><code>┌─────────────────────────────────┐
│  Header (magic, segment#, ts)   │
├─────────────────────────────────┤
│  Entry: flatbuffer-encoded      │
│  Entry: flatbuffer-encoded      │
│  ...                            │
└─────────────────────────────────┘</code></pre><h3 id="storage-engine">Storage Engine<a class="anchor" href="#storage-engine">#</a></h3>
<p>Multi-modal storage built on B+Trees with MemTable overlay.</p>
<table>
  <thead>
      <tr>
          <th>Component</th>
          <th>Technology</th>
          <th>Purpose</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>MemTable</strong></td>
          <td>In-memory skip list</td>
          <td>Write buffer, recent reads</td>
      </tr>
      <tr>
          <td><strong>B+Tree</strong></td>
          <td>LMDB/BoltDB</td>
          <td>Persistent sorted storage</td>
      </tr>
      <tr>
          <td><strong>Encoding</strong></td>
          <td>Model-specific key schemas</td>
          <td>Key Space isolation</td>
      </tr>
  </tbody>
</table>
<p><strong>Storage Models</strong>:</p>
<pre tabindex="0"><code>Key-Value:      &lt;key&gt; -&gt; &lt;value&gt;
Wide-Column:    &lt;rowKey&gt;:&lt;colName&gt; -&gt; &lt;colValue&gt;
Large Object:   &lt;objectKey&gt;:chunk:&lt;N&gt; -&gt; &lt;chunk_data&gt;</code></pre><h3 id="replication-system">Replication System<a class="anchor" href="#replication-system">#</a></h3>
<p>gRPC-based WAL streaming with bidirectional flow control.</p>
<p><strong>Replicator Role</strong> (Primary):</p>
<ul>
<li>Streams WAL segments to connected relayers</li>
</ul>
<p><strong>Relayer Role</strong> (Replica):</p>
<ul>
<li>Consumes from one or more upstream servers</li>
<li>Applies segments in order to local storage</li>
<li>Can fan-out to downstream relayers (multi-hop)</li>
</ul>
<p><strong>Guarantees</strong>:</p>
<ul>
<li><strong>Consistency Model</strong>: Eventual (all replicas converge)</li>
<li><strong>Delivery</strong>: At-least-once with gap detection</li>
<li><strong>Ordering</strong>: Strict segment sequence enforcement</li>
</ul>
<h3 id="namespace-watch-api">Namespace Watch API<a class="anchor" href="#namespace-watch-api">#</a></h3>
<p>Lightweight, best-effort notification system for real-time change awareness.</p>
<p><strong>Event Structure</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;namespace&#34;</span>: <span style="color:#e6db74">&#34;users&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;key&#34;</span>: <span style="color:#e6db74">&#34;user:123&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;operation&#34;</span>: <span style="color:#e6db74">&#34;put&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;entry_type&#34;</span>: <span style="color:#e6db74">&#34;kv&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;seq_num&#34;</span>: <span style="color:#ae81ff">42</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><table>
  <thead>
      <tr>
          <th>Field</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>namespace</code></td>
          <td>Namespace where change occurred</td>
      </tr>
      <tr>
          <td><code>key</code></td>
          <td>Exact key that changed</td>
      </tr>
      <tr>
          <td><code>operation</code></td>
          <td>Operation: <code>put</code>, <code>delete</code>, <code>delete_row</code></td>
      </tr>
      <tr>
          <td><code>entry_type</code></td>
          <td>Operation: <code>kv</code>, <code>lob</code>, <code>row</code></td>
      </tr>
      <tr>
          <td><code>seq</code></td>
          <td>Monotonic sequence number (per-namespace ordering of events)</td>
      </tr>
  </tbody>
</table>
<p><strong>Characteristics</strong>:</p>
<ul>
<li><strong>Per-namespace streams</strong>: Independent event streams per namespace</li>
<li><strong>Ordered delivery</strong>: Events delivered in sequence order (if received)</li>
<li><strong>Fire-and-forget</strong>: No acknowledgments, best-effort delivery</li>
<li><strong>Ring buffer</strong>: Configurable size-based event retention</li>
<li><strong>Backpressure handling</strong>: Events dropped if subscribers can&rsquo;t keep up</li>
</ul>
<p><strong>Delivery Guarantees</strong>:</p>
<ul>
<li>Events may be dropped if consumer can&rsquo;t keep up.</li>
<li>Cannot replay from a specific sequence</li>
<li>Subscribers not notified of missed events</li>
</ul>
<p><strong>Use Cases</strong>:</p>
<ul>
<li>Cache invalidation across microservices</li>
<li>Trigger event-driven workflows</li>
<li>Local application coordination</li>
<li>NOT for critical workflows requiring guaranteed delivery (use gRPC replication instead)</li>
</ul>
<p><strong>Example Flow</strong>:</p>
<pre tabindex="0"><code>Application A: PUT user:123 → UnisonDB appends to WAL →
Watch stream publishes: {namespace:&#34;users&#34;, key:&#34;user:123&#34;, entry_type:&#34;PUT&#34;, seq:42} →
Applications B, C, D receive notification and react</code></pre><h2 id="design-principles">Design Principles<a class="anchor" href="#design-principles">#</a></h2>
<h3 id="multi-modal-storage-examples">Multi-Modal Storage Examples<a class="anchor" href="#multi-modal-storage-examples">#</a></h3>
<p>All storage models share the same WAL and B+Tree, differing only in key encoding:</p>
<table>
  <thead>
      <tr>
          <th>Model</th>
          <th>Example</th>
          <th>Key Encoding</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Key-Value</strong></td>
          <td><code>user:123</code> → <code>{&quot;name&quot;:&quot;Alice&quot;}</code></td>
          <td><code>&lt;key&gt;</code></td>
      </tr>
      <tr>
          <td><strong>Wide-Column</strong></td>
          <td><code>user:123</code> with columns <code>name</code>, <code>email</code></td>
          <td><code>&lt;rowKey&gt;:&lt;colName&gt;</code></td>
      </tr>
      <tr>
          <td><strong>Large Object</strong></td>
          <td><code>video:abc</code> as streamable chunks</td>
          <td><code>&lt;objectKey&gt;:chunk:&lt;N&gt;</code></td>
      </tr>
  </tbody>
</table>
<h3 id="edge-first-topology">Edge-First Topology<a class="anchor" href="#edge-first-topology">#</a></h3>
<p>Designed for hub-and-spoke, multi-hop replication with data locality:</p>
<pre tabindex="0"><code>          ┌──────────────┐
          │   Primary    │  (Repliactor Mode - accepts writes)
          │   (US-East)  │
          └──────┬───────┘
                 │ gRPC (durable replication)
        ┌────────┼────────┐
        ↓        ↓        ↓
    ┌───────┐┌───────┐┌───────┐
    │Europe ││ Asia  ││US-West│  (Relayer Mode - read replicas)
    │Relayer││Relayer││Relayer│
    └───┬───┘└───┬───┘└───┬───┘
        │        │        │ Watch API (local events)
        ↓        ↓        ↓
    Local    Local    Local
    Apps     Apps     Apps</code></pre><h2 id="data-flow">Data Flow<a class="anchor" href="#data-flow">#</a></h2>
<h3 id="write-path-server-mode">Write Path (Server Mode)<a class="anchor" href="#write-path-server-mode">#</a></h3>
<pre tabindex="0"><code>Write Request → API Handler → Storage Engine
                                    ↓
                    ┌───────────────┴───────────────┐
                    ↓                               ↓
            1. WAL Append                   2. MemTable Update
               (+ fsync)                       (in-memory)
                    ↓                               ↓
            3. Background Flush ────────────────→ B+Tree (LMDB)
                    ↓
            ┌───────┴────────┐
            ↓                ↓
    gRPC Stream        Watch Event
    (to relayers)      (to local apps)</code></pre><h3 id="read-path">Read Path<a class="anchor" href="#read-path">#</a></h3>
<pre tabindex="0"><code>Read Request → API Handler → Storage Engine
                                    ↓
                            ┌───────┴───────┐
                            ↓               ↓
                      MemTable          B+Tree
                      (check first)  (if not found)
                            └───────┬───────┘
                                    ↓
                            Merge &amp; Response</code></pre><h3 id="replication-flow-grpc">Replication Flow (gRPC)<a class="anchor" href="#replication-flow-grpc">#</a></h3>
<pre tabindex="0"><code>Replicator (Primary)                     Relayer (Replica)
      │                                      │
      │ ─── WAL Segment (gRPC stream) ────→  |
      │     [metadata + binary + CRC]        │
      │                                      ↓
      │                              1. Validate checksum
      │                              2. Append to local WAL
      │                              3. Apply to MemTable
      │                              4. Flush to B+Tree
      │                                      ↓
      │                              Can relay downstream
      │                              Can notify local apps</code></pre><h3 id="watch-event-flow">Watch Event Flow<a class="anchor" href="#watch-event-flow">#</a></h3>
<pre tabindex="0"><code>WAL Write → Watch Event Builder → Ring Buffer → Transport Layer
                                                      │
                                       ┌──────────────┼──────────────┐
                                       ↓              ↓              ↓
                                    App A          App B          App C
                                 (subscriber)   (subscriber)   (subscriber)</code></pre><p><strong>Event Details</strong>:</p>
<ul>
<li>Triggered on every WAL append (PUT/DELETE/UPDATE)</li>
<li>Buffered in ring buffer (configurable size)</li>
<li>Events dropped if buffer full or subscriber slow</li>
</ul>
<h2 id="storage-layout">Storage Layout<a class="anchor" href="#storage-layout">#</a></h2>
<pre tabindex="0"><code>data/
├── &lt;namespace&gt;/
│   ├── wal/
│   │   ├── segment-00000000     # 16MB segments (configurable)
│   │   ├── segment-00000001
│   │   └── ...
│   ├── db/
│   │   ├── data.mdb             # LMDB data file
│   │   └── lock.mdb             # LMDB lock file
│   └── checkpoint/
│       └── last_applied         # Recovery point</code></pre><p><strong>Per-Namespace Isolation</strong>: Each namespace has independent WAL, DB, and checkpoint state.</p>
<h2 id="system-characteristics">System Characteristics<a class="anchor" href="#system-characteristics">#</a></h2>
<h3 id="consistency-model">Consistency Model<a class="anchor" href="#consistency-model">#</a></h3>
<table>
  <thead>
      <tr>
          <th>Aspect</th>
          <th>Guarantee</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Writes</strong></td>
          <td>Single primary (Replicator Mode) for linearizability</td>
      </tr>
      <tr>
          <td><strong>Reads</strong></td>
          <td>Eventually consistent across relayers</td>
      </tr>
      <tr>
          <td><strong>Replication</strong></td>
          <td>At-least-once delivery, ordered segments</td>
      </tr>
      <tr>
          <td><strong>Isolation</strong></td>
          <td>Per-namespace (independent namespaces)</td>
      </tr>
  </tbody>
</table>
<h3 id="durability--recovery">Durability &amp; Recovery<a class="anchor" href="#durability--recovery">#</a></h3>
<p><strong>Crash Recovery</strong>:</p>
<ol>
<li>Scan WAL for uncommitted operations</li>
<li>Replay WAL to rebuild MemTable and B+Tree</li>
<li>Validate checkpoint consistency</li>
<li>Resume operations</li>
</ol>
<p><strong>Replication Recovery</strong> (Relayer Mode):</p>
<ol>
<li>Determine last applied segment from checkpoint</li>
<li>Reconnect to upstream at last offset</li>
<li>Request missing segments (gap detection)</li>
<li>Apply backlog before serving reads</li>
</ol>
<p><strong>Data Durability</strong>:</p>
<ul>
<li>WAL with optional fsync (configurable)</li>
<li>CRC32 checksums on all WAL entries</li>
<li>Segment-level validation during replication</li>
</ul>
<h2 id="deployment-topologies">Deployment Topologies<a class="anchor" href="#deployment-topologies">#</a></h2>
<p>UnisonDB supports various deployment patterns. See the <strong><a href="../deployment/" target="_blank" rel="noopener noreferrer">Deployment Guide</a>
</strong> for detailed configurations and examples.</p>
<h3 id="example-hub-and-spoke">Example: Hub-and-Spoke<a class="anchor" href="#example-hub-and-spoke">#</a></h3>
<pre tabindex="0"><code>           ┌──────────┐
           │   Hub    │ (Replicator Mode)
           └────┬─────┘
                │ gRPC (durable replication)
     ┌──────────┼──────────┐
     ↓          ↓          ↓
  ┌──────┐  ┌──────┐  ┌──────┐
  │Edge 1│  │Edge 2│  │Edge 3│ (Relayers)
  └──┬───┘  └──┬───┘  └──┬───┘
     │         │         │ Watch API (local events)
     ↓         ↓         ↓
  Local     Local     Local
  Apps      Apps      Apps</code></pre><p><strong>Key characteristics:</strong></p>
<ul>
<li>Central hub accepts all writes</li>
<li>Edge relayers provide data locality</li>
<li>Local applications subscribe to watch events</li>
</ul>
<p>For detailed configurations, monitoring, and operational guidance, see the <strong><a href="../deployment/" target="_blank" rel="noopener noreferrer">Deployment Topologies Guide</a>
</strong>.</p>
<h2 id="tradeoffs--limitations">Tradeoffs &amp; Limitations<a class="anchor" href="#tradeoffs--limitations">#</a></h2>
<h3 id="design-tradeoffs">Design Tradeoffs<a class="anchor" href="#design-tradeoffs">#</a></h3>
<table>
  <thead>
      <tr>
          <th>Aspect</th>
          <th>Tradeoff</th>
          <th>Rationale</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Write Scalability</strong></td>
          <td>Single primary per namespace</td>
          <td>Ensures linearizable writes, simplifies conflict resolution</td>
      </tr>
      <tr>
          <td><strong>Read Consistency</strong></td>
          <td>Eventual consistency on relayers</td>
          <td>Enables high read scalability and data locality</td>
      </tr>
      <tr>
          <td><strong>Replication Model</strong></td>
          <td>At-least-once delivery</td>
          <td>Prioritizes availability over exactly-once semantics</td>
      </tr>
      <tr>
          <td><strong>Watch Events</strong></td>
          <td>At-most-once, best-effort</td>
          <td>Minimizes latency, lightweight notification for non-critical use cases</td>
      </tr>
  </tbody>
</table>
<h3 id="current-limitations">Current Limitations<a class="anchor" href="#current-limitations">#</a></h3>
<ol>
<li><strong>Write Scaling</strong>: Single primary per namespace (no multi-master)</li>
<li><strong>Consistency</strong>: No strong consistency guarantees for relayer reads</li>
<li><strong>Transactions</strong>: Limited to single-namespace operations</li>
<li><strong>Query Model</strong>: No complex queries (no SQL, joins, aggregations)</li>
<li><strong>Schema</strong>: Schema-less (application-managed structure)</li>
</ol>
<h3 id="when-to-use-unisondb">When to Use UnisonDB<a class="anchor" href="#when-to-use-unisondb">#</a></h3>
<p><strong>Good Fit</strong>:</p>
<ul>
<li>Edge computing with hub-and-spoke topology</li>
<li>Read-heavy workloads requiring data locality</li>
<li>Event-driven architectures (via Watch API)</li>
<li>Applications tolerating eventual consistency</li>
<li>Key-value or wide-column access patterns</li>
<li>Large object storage with streaming</li>
</ul>
<p><strong>Not a Good Fit</strong>:</p>
<ul>
<li>Strong consistency requirements across replicas</li>
<li>Complex relational queries (joins, aggregations)</li>
<li>Multi-region active-active writes</li>
<li>Workloads requiring ACID transactions across namespaces</li>
</ul>
<h2 id="summary">Summary<a class="anchor" href="#summary">#</a></h2>
<p>UnisonDB combines <strong>database semantics</strong> with <strong>streaming mechanics</strong> through:</p>
<ol>
<li><strong>Log-Native Design</strong>: WAL as first-class citizen (replication = log streaming)</li>
<li><strong>Dual Communication</strong>: gRPC for distribution, Watch API for local reactivity</li>
<li><strong>Dual Modes</strong>: Server (writable primary) and Relayer (read replicas)</li>
<li><strong>Multi-Modal Storage</strong>: Key-Value, Wide-Column, Large Objects on shared B+Tree</li>
</ol>
<p><strong>Architecture Strengths</strong>:</p>
<ul>
<li>Data locality through edge replicas</li>
<li>Event-driven integration via Watch API</li>
<li>Simple operational model (log streaming)</li>
<li>Flexible deployment topologies (hub-and-spoke, multi-hop)</li>
</ul>
<p><strong>Best For</strong>: Edge computing, local-first applications, and read-scalable systems with eventual consistency tolerance.</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">

<div>

</div>

<div>

  <a class="flex align-center" href="https://github.com/ankur-anand/unisondb/edit/main/docs/content/docs/architecture/_index.md" target="_blank" rel="noopener edit">
    <img src="/icons/edit.svg" class="book-icon" alt="Edit" />
    <span>Edit this page</span>
  </a>

</div>

</div>





  
  
  
  <div class="flex flex-wrap justify-between">
    <span>
    
      <a href="/docs/getting-started/configurations/" class="flex align-center">
        <img src="/icons/backward.svg" class="book-icon" alt="Backward" />
        <span>Configuration</span>
      </a>
    
    </span>
    <span>
    
      <a href="/docs/api/" class="flex align-center">
        <span>API Reference</span>
        <img src="/icons/forward.svg" class="book-icon" alt="Forward" />
      </a>
    
    </span>
  </div>
  


 
        
  
 
        
        
  
 
        
  
  
    <script>(function(){document.querySelectorAll("pre:has(code)").forEach(e=>{e.addEventListener("click",e.focus),e.addEventListener("copy",function(t){if(t.preventDefault(),navigator.clipboard){const t=window.getSelection().toString()||e.textContent;navigator.clipboard.writeText(t)}})})})()</script>
  

      </footer>

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
  
  <aside class="book-toc">
    <div class="book-toc-content">
      
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#architecture-overview">Architecture Overview</a>
      <ul>
        <li><a href="#key-characteristics">Key Characteristics</a></li>
        <li><a href="#core-concepts">Core Concepts</a>
          <ul>
            <li><a href="#1-log-native-design">1. Log-Native Design</a></li>
            <li><a href="#2-operational-modes">2. Operational Modes</a></li>
            <li><a href="#3-dual-communication-channels">3. Dual Communication Channels</a></li>
          </ul>
        </li>
        <li><a href="#system-architecture">System Architecture</a></li>
        <li><a href="#core-components">Core Components</a>
          <ul>
            <li><a href="#write-ahead-log-wal">Write-Ahead Log (WAL)</a></li>
            <li><a href="#storage-engine">Storage Engine</a></li>
            <li><a href="#replication-system">Replication System</a></li>
            <li><a href="#namespace-watch-api">Namespace Watch API</a></li>
          </ul>
        </li>
        <li><a href="#design-principles">Design Principles</a>
          <ul>
            <li><a href="#multi-modal-storage-examples">Multi-Modal Storage Examples</a></li>
            <li><a href="#edge-first-topology">Edge-First Topology</a></li>
          </ul>
        </li>
        <li><a href="#data-flow">Data Flow</a>
          <ul>
            <li><a href="#write-path-server-mode">Write Path (Server Mode)</a></li>
            <li><a href="#read-path">Read Path</a></li>
            <li><a href="#replication-flow-grpc">Replication Flow (gRPC)</a></li>
            <li><a href="#watch-event-flow">Watch Event Flow</a></li>
          </ul>
        </li>
        <li><a href="#storage-layout">Storage Layout</a></li>
        <li><a href="#system-characteristics">System Characteristics</a>
          <ul>
            <li><a href="#consistency-model">Consistency Model</a></li>
            <li><a href="#durability--recovery">Durability &amp; Recovery</a></li>
          </ul>
        </li>
        <li><a href="#deployment-topologies">Deployment Topologies</a>
          <ul>
            <li><a href="#example-hub-and-spoke">Example: Hub-and-Spoke</a></li>
          </ul>
        </li>
        <li><a href="#tradeoffs--limitations">Tradeoffs &amp; Limitations</a>
          <ul>
            <li><a href="#design-tradeoffs">Design Tradeoffs</a></li>
            <li><a href="#current-limitations">Current Limitations</a></li>
            <li><a href="#when-to-use-unisondb">When to Use UnisonDB</a></li>
          </ul>
        </li>
        <li><a href="#summary">Summary</a></li>
      </ul>
    </li>
  </ul>
</nav>



    </div>
  </aside>
  
 
  </main>

  
</body>
</html>




















